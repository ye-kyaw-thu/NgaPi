# How to Build a FastText Model

တကယ်လို့ ကိုယ့်မှာ ရှိတဲ့ corpus နဲ့ fasttext model ဆောက်ချင်ရင်လည်း ဆောက်လို့ ရပါတယ်။  

ကိုယ့်စက်ထဲမှာ FastText command line နဲ့ run လို့ရအောင် ပြင်ဆင်ထားပြီးပြီ ဆိုရင်တော့ command line ကနေလည်း သွားလို့ ရပါလိမ့်မယ်။ ဒီနေရာမှာ ရှင်းပြမှာက build-fasttext-model.py ဆိုတဲ့ python program ကို သုံးပြီး မော်ဒယ်အသစ်ဆောက်တဲ့ ဥပမာပါ။ ဒီပရိုဂရမ်ကို မ run ခင်မှာတော့ "pip install fasttext" နဲ့ အရင်ဆုံး python library ကို install လုပ်ထားရပါလိမ့်မယ်။  

## Python Program Information  
    
ရေးထားတဲ့ ပရိုဂရမ်ရဲ့ --help option နဲ့ command line option တွေကို လေ့လာပါ။  

```
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$ python ./build-fasttext-model.py --help
usage: build-fasttext-model.py [-h] --input INPUT [--output OUTPUT] [--model {skipgram,cbow}]
                               [--dim DIM] [--epoch EPOCH] [--lr LR] [--ws WS]

Build a FastText model from word-segmented text.

optional arguments:
  -h, --help            show this help message and exit
  --input INPUT         Path to the training text file (word-segmented UTF-8).
  --output OUTPUT       Filename for saving the FastText model (default: fasttext_model.bin).
  --model {skipgram,cbow}
                        Model type: skipgram or cbow (default: skipgram).
  --dim DIM             Dimensionality of word vectors (default: 100).
  --epoch EPOCH         Number of epochs (default: 5).
  --lr LR               Learning rate (default: 0.05).
  --ws WS               Context window size (default: 5).
```

## Corpus Information

Syllable ဖြတ်ထားတဲ့ corpus ကို သုံးပြီး ဆောက်မယ် ဆိုရင် syllable ကြိုဖြတ်ထားပါ။ FastText model ကို ဆောက်မယ်ဆိုရင် ဒေတာကို segmentation unit တစ်ခုခုနဲ့တော့ ဖြတ်ထားသင့်ပါတယ်။  
  
```
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$ head -n 5 ./data/myWord_myPOS_myPara_myNovel1v1_wordseg.shuf.cleaned.syl.normalized
ကြိုး စား နေ ပါ တယ်
အား လုံး ညှစ် တယ်
လယ် ယာ လုပ် ငန်း ကို အ ဓိ က လုပ် ကိုင် ပြီး မြန် မာ့ ဓ လေ့ ဝါး ဓ နိ အိမ် များ အ များ စု စု ဖွဲ့ တည် ရှိ နေ သည့် အေး ကျေး ရွာ ၏ အ ဓိ က ရေ အ ရင်း အ မြစ် အ ဖြစ် စ ပါး ရေ သွင်း စိုက် ပျိုး ရန် အ တွက် နိုင် ငံ တော် အ စိုး ရ က တူး မြောင်း တစ် ခု ဆောက် လုပ် ကာ ဧ ရာ ဝ တီ မြစ် မှ ရေ ကို သွယ် ယူ ပေး ထား ပြီး ကျေး ရွာ လူ ထု သောက် သုံး ရန် ချက် ပြုတ် ရာ တွင် အ သုံး ပြု ရန် အ တွက် မူ အ ဝီ စိ ရေ သွယ် ယူ သည့် ပိုက် တစ် ခု သာ လျှင် ရှိ ပါ သည်
သူ ဟာ ဘေး ဘျမ်း ကင်း ကင်း နဲ့ ပြန် ရောက် လာ ခဲ့ တယ် လေ
အ ခု ချိန် မှာ ထိုင် ဝမ် က နေ ဗြိ တိန် ကို တိုက် ရိုက် လေ ယာဉ် မ ရှိ ဘူး ခင် ဗျား ဟောင် ကောင် က နေ တ ဆင့် သွား ရ မယ်
```

## Building a FastText Embedding Model  

မော်ဒယ်ကို သိမ်းမှာက ဖိုလ်ဒါအသစ်မှာ ဆိုရင် ဖိုလ်ဒါကို အရင်ကြိုဆောက်ထားပါ။  
Skipgram fasttext model တစ်ခုကို ဥပမာအနေနဲ့ ဆောက်မယ်ဆိုရင် အောက်ပါအတိုင်း run ပါ။  

```
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$ time python ./build-fasttext-model.py --input ./data/myWord_myPOS_myPara_myNovel1v1_wordseg.shuf.cleaned.syl.normalized --model skipgram --output ./model/myfasttext_v1.bin
2024-12-25 14:21:16,979 - Starting FastText model training with model_type=skipgram, dim=100, epoch=5, lr=0.05, ws=5...
Read 10M words
Number of words:  3462
Number of labels: 0
Progress: 100.0% words/sec/thread:  118362 lr:  0.000000 avg.loss:  2.414529 ETA:   0h 0m 0s
2024-12-25 14:21:31,942 - Saving FastText model to './model/myfasttext_v1.bin'...
2024-12-25 14:21:32,868 - FastText model training completed successfully.

real    0m16.196s
user    7m7.098s
sys     0m4.262s
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$
```

Skipgram fasttext model ဖိုင်က 766M ပါ။  

```
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$ ll -h ./model/myfasttext_v1.bin
-rw-rw-r-- 1 ye ye 766M Dec 25 14:21 ./model/myfasttext_v1.bin
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$
```

## Bin2Vec

```
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$ python bin2vec.py --binary_file ./model/myfasttext_v1.bin --vector_file ./model/myfasttext_v1.vec
Converted ./model/myfasttext_v1.bin to ./model/myfasttext_v1.vec in pure text format successfully.
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github$
```

Check converted vector file:  

```
3462 100
အ -0.020812677 0.014222041 0.14707279 -0.1842381 -0.061052196 -0.057658885 -0.03292892 0.04936385 -0.025804132 0.0734657 -0.1159874 0.016686555 0.35442472 -0.14443621 0.05544194 0.12364729 -0.023075808 0.09519182 -0.045482293 0.029036311 -0.2193143 0.18958911 0.18115446 0.2333122 0.1195823 -0.008966078 0.411379 -0.08511002 0.047515854 -0.09509543 0.08582706 0.03881732 -0.055743393 0.03412059 -0.16639902 -0.28278458 -0.032576233 0.10848193 -0.020877324 -0.0009929277 -0.06336136 -0.14327583 -0.031124137 -0.08016338 -0.024092454 0.07601534 0.065982565 0.17565352 -0.10458869 0.18354851 0.1652404 0.09512043 -0.083493486 0.24238697 -0.17059515 0.010160673 -0.09070958 0.1116292 -0.037382837 0.2967968 -0.14358653 0.04922141 -0.22735184 0.01362576 -0.07403269 0.07475961 -0.19550946 -0.08912936 0.06503683 -0.14732634 -0.042020865 0.16236758 0.0344707 0.110176384 -0.04351531 0.02504056 -0.017584132 -0.019345423 0.14525683 0.018760469 -0.11468452 -0.16687019 0.12602636 -0.11606391 -0.05526773 0.0042534173 0.12149795 -0.09459259 -0.10891135 -0.2414366 0.073258676 -0.0504788 0.15406191 -0.024610322 0.015399458 -0.1084087 0.104009554 -0.05159897 -0.21134643 -0.029999733
</s> 0.12382664 -0.012683906 0.041837506 -0.06987271 0.06381257 0.06208927 -0.23126368 0.048813067 0.08809406 0.039452787 -0.22591248 0.10878711 0.24657933 -0.09025508 -0.20819944 0.11296403 -0.0023698541 0.13694344 0.046330955 -0.06459741 -0.011776806 0.0020629307 0.008789067 0.26550153 -0.022911312 -0.04013552 0.0279873 0.017961724 -0.0054563517 -0.026302485 0.08658377 -0.102739446 -0.0013639664 0.20668857 0.004934055 -0.34088972 0.2774442 0.08034218 0.16066907 -0.21243756 0.0037596314 0.058731575 -0.049128115 -0.0017906616 0.094759576 0.062752426 -0.058349565 0.05442252 0.02527177 0.28109205 -0.17506446 -0.24817337 -0.2785353 0.036080763 -0.07960388 -0.19838692 -0.09586938 0.032010466 -0.12380073 0.13872214 -0.096330285 0.08983679 0.10626658 0.06370716 0.091440745 -0.0612045 0.0082077 0.0670313 -0.017856117 -0.21964775 0.05315741 0.0147147095 -0.1176217 0.06689351 0.045692213 -0.027084365 -0.12495102 -0.038943823 0.19913141 0.10390068 0.11612357 0.051901486 0.17593633 0.18200813 -0.24298528 0.14925897 0.012650026 0.18348004 0.019809598 -0.4322835 -0.13959268 -0.20270965 0.15223348 -0.13839447 0.2104736 -0.09130107 -0.1292427 0.19842337 -0.32999054 -0.07565341
မ -0.037138704 -0.13569695 0.05291237 -0.23952962 0.054309398 0.08480413 -0.12574023 -0.10288342 0.26802805 -0.023060258 -0.19200593 0.048837014 0.13388237 -0.10156472 -0.27330744 0.06254955 -0.018021502 0.10738753 -0.08699856 -0.11971502 -0.02427984 0.00821751 0.011763198 0.22179054 0.0405163 -0.064645365 0.21057953 -0.20626605 0.052216925 0.06893001 -0.083571464 0.062132645 -0.03155385 0.1259717 -0.14362349 -0.29381698 -0.024351114 0.09014881 -0.02725529 -0.084978566 -0.034774803 -0.046036735 -0.14072639 0.124127895 -0.096729 0.16550906 0.078789495 0.18324527 0.059834424 0.07983999 -0.22204566 -0.0071226573 -0.22143735 0.14136066 -0.18776268 0.111439355 -0.034212455 0.29030272 0.062479146 0.13921164 -0.011364475 0.16420348 -0.18552603 0.2543297 -0.0671265 -0.1643539 -0.1521545 0.011511192 -0.14606753 -0.18639424 -0.091895506 -0.038037926 -0.013226733 -0.020700991 -0.1304299 -0.10411659 -0.123490945 -0.121870376 0.025200529 -0.0728125 0.02042448 0.0319191 0.16621827 -0.0046351263 -0.07936244 -0.02828452 -0.07946257 -0.013573024 0.0023430604 -0.2846415 0.004855334 -0.1849191 0.26290923 0.06771301 0.33243358 -0.018295549 0.14210498 0.07429257 -0.16856532 -0.097810596
ပါ -0.087525435 -0.005859427 0.27533922 -0.02983224 -0.039899968 0.049487114 -0.28226385 0.17397852 0.23602515 0.00026850402 -0.25732568 -0.12463488 0.08218895 -0.03002106 -0.11644097 0.11331933 0.16041115 0.2823048 0.0058015343 -0.008242266 -0.11977239 -0.16394351 -0.11037723 0.23661324 -0.08783595 0.09576425 0.299117 0.003330242 0.076135896 -0.13499334 -0.089114785 0.10768247 -0.102942936 0.3175604 -0.06907454 -0.26737332 0.19487469 0.027710423 0.1234796 -0.27797264 -0.036803883 0.07294426 -0.19873166 -0.06823772 -0.111085676 0.123619474 0.28799415 0.13046129 -0.09571865 0.33422554 -0.04376065 -0.2152585 -0.35091978 0.013717361 -0.1434667 -0.2915153 -0.10823727 0.048322715 -0.12467216 0.2949836 -0.18683922 0.20867643 -0.096441984 0.16219223 0.038168233 -0.20211723 -0.061449233 0.10116825 -0.10512587 -0.18431446 -0.0693818 0.022668384 -0.018073462 0.12479973 -0.0061559975 -0.021700172 -0.057297543 -0.051328972 0.18727888 0.15065491 0.001404902 -0.0042740926 0.17474222 -0.043993764 -0.036044426 -0.06262929 -0.017722342 -0.1013968 0.16547391 -0.31008813 -0.01926384 0.019985143 -0.077733725 -0.16357918 0.00094194524 0.031407647 0.01720908 0.1017039 -0.21075726 0.054990195
က 0.005586397 0.0035553724 0.043903466 -0.025929756 0.06820154 -0.083473936 0.17526793 0.025444353 -0.010341607 0.012500547 -0.06879764 -0.022912554 0.19046825 -0.09192437 -0.065295674 -0.0124853905 -0.05358848 0.14326698 -0.021700917 -0.008445582 -0.054013252 0.019059066 0.09665468 0.22297117 -0.042007785 0.0563076 0.42052028 -0.13233158 0.22632253 -0.013369214 0.006161142 -0.07444376 -0.22130388 -0.016274836 -0.11054453 -0.21350713 -0.012493099 0.1371899 0.043665145 -0.021117441 -0.068028174 -0.04764892 0.010197798 0.035215147 -0.040331736 0.10699217 0.20265245 0.24131921 0.09565459 0.1330294 0.012323478 0.13944894 -0.04777919 0.14558257 -0.009986118 -0.11140704 0.076862484 0.059137706 -0.15367246 0.1172542 -0.039038908 0.0800514 -0.16803804 0.18416142 -0.046993427 -0.09745307 -0.039417863 -0.049574837 -0.055808738 -0.009096504 -0.020848284 0.19776654 0.15017495 -0.013011406 -0.09384664 0.021649998 -0.13679193 -0.13376203 -0.022702852 0.07466504 -0.111704424 -0.077716 -0.06293553 0.14709842 -0.0823473 0.17380673 -0.022408854 0.00034506433 -0.19590604 -0.08407478 0.14193982 0.0018730997 0.27397293 -0.07504713 0.024243716 0.19164222 0.12516136 -0.0275762 -0.31775403 -0.32855007
ကို -0.14035897 -0.20247672 0.1522462 -0.1592438 -0.04335637 -0.10129674 0.0289356 0.05071132 0.0889965 -0.00135214 -0.16407943 0.04276938 0.216871 -0.16061687 -0.07371625 0.13684046 -0.16825767 0.09134262 0.024781587 0.13245153 -0.24981527 0.023143714 0.1167979 0.15466931 -0.071643785 0.089075245 0.37485343 -0.09469601 0.120481886 -0.23762815 -0.004829833 -0.10042644 -0.09305838 0.12268869 -0.18135175 -0.22339243 0.070216134 0.10949483 0.11248172 -0.13408911 -0.03096802 0.03587532 -0.0010756084 0.025387011 -0.22672552 0.036987174 0.045254923 0.15705995 0.03835295 0.21106799 0.07006357 0.024549434 -0.116572715 0.2365292 -0.0064354967 -0.27123913 -0.04282965 0.046844672 -0.0775909 0.32956553 0.039943602 0.05636056 -0.24621639 0.23866582 -0.16478834 0.10037286 -0.03135763 -0.06522189 0.047627356 0.06016024 -0.03588742 -0.00063734397 0.04921951 0.08579688 -0.05137061 -0.06604894 -0.1606001 0.05543119 0.1622271 0.055894613 0.009143041 0.10874284 0.15345165 0.11906961 -0.041506276 0.01619666 -0.22009136 -0.007732209 -0.019190013 -0.3299635 0.00041829105 -0.07723701 0.16245684 0.03912612 0.11016564 -0.008738305 0.16529053 0.059800748 -0.14611718 -0.098225154
တယ် -0.120471336 -0.018285215 0.4533828 0.056147113 -0.063245565 0.053406563 -0.4467594 0.0973573 0.015560304 -0.0075013405 -0.25234514 -0.058425974 0.17098938 -0.23994355 -0.1640212 0.27626455 0.07986635 -0.119295485 -0.0050384915 -0.11835963 -0.0015431303 -0.12790558 0.018034093 0.47423318 0.09921052 0.04763681 0.30432615 -0.08247365 0.12788221 -0.12415005 0.10119429 0.11169708 -0.0354309 0.25630134 -0.13584085 -0.4440856 0.24584708 0.11716656 0.13736127 -0.12940744 -0.011258109 0.0792069 -0.16058801 -0.044098046 -0.290039 0.12187289 0.26664132 0.25621757 -0.043904074 0.501729 -0.024915602 -0.21647009 -0.10493446 -0.030752532 0.065629736 -0.4260809 -0.06419717 0.009782156 0.07937679 0.16467118 -0.15726167 0.038465332 -0.15767308 -0.021764314 0.04305435 -0.18023114 -0.24379285 -0.1954492 -0.09574732 -0.059373423 0.23023994 0.10441988 0.109726496 0.06956385 -0.012988484 0.14208709 -0.11922363 -0.18472713 0.1308994 0.26774776 -0.12838815 0.18306153 0.12675257 0.09087505 0.008301395 0.0007042864 -0.24252665 -0.2013461 0.06217788 -0.20095687 -0.09003493 -0.11727926 0.017054338 -0.09944423 -0.103094645 0.14915675 0.09124262 0.13907568 -0.37772167 -0.110662974
နေ 0.048886072 -0.011819106 0.2975276 -0.0012909761 0.1251401 -0.028090375 -0.095248684 -0.0032416787 0.12339536 -0.0053562075 -0.22194068 -0.12946838 0.25370762 -0.21229751 -0.05537299 0.037339985 -0.041386064 0.06714039 -0.18557784 0.083090864 -0.09687073 0.023984643 0.075407386 0.22928321 0.024193095 -0.09934579 0.28638634 0.09949465 -0.01919273 -0.13266549 -0.09923762 0.074267074 -0.08712657 0.13067636 -0.20511693 -0.36451292 0.28716242 -0.19483468 0.009250808 0.013777632 -0.11485828 -0.007749319 -0.025535172 0.030564219 -0.17353758 0.11538676 0.13587792 0.2224195 -0.04777381 0.2729874 0.01848652 -0.095303684 -0.22759122 0.24076937 -0.05552526 -0.16929159 0.032177873 0.05935123 0.053086184 0.20018654 0.040758073 -0.0027874839 -0.0646288 0.21544237 -0.046396684 0.15841709 -0.116035566 -0.075150385 0.094882146 -0.06554534 -0.030115541 -0.034544855 -0.051330484 0.057215557 0.033348918 0.17677371 -0.24633877 -0.06970134 0.18098429 0.05667135 0.001614477 -0.0012523048 -0.04237651 -0.04455544 -0.09252065 0.19407815 -0.022971122 0.04657116 0.07657422 -0.11040982 -0.1414829 0.01112334 0.3202184 -0.0647468 0.033276737 -0.07872544 0.1207119 -0.05889726 -0.2059288 -0.13019425
ရ 0.07895931 0.021591492 -0.00974522 -0.1954571 0.03715715 0.19192086 -0.16420113 -0.048558295 0.180944 -0.039754268 -0.21430117 0.015529577 0.24136762 0.01799596 -0.04952926 0.083865896 -0.07847873 0.113229685 -0.1036828 0.14505091 -0.15163416 0.13571873 -0.036331203 0.26130563 0.022977222 -0.017934687 0.14438695 -0.15869294 0.16259226 0.10760036 -0.057033528 0.04902984 -0.16630113 0.04820086 -0.03314672 -0.096001126 0.065662146 0.01041087 0.072664514 -0.03414534 -0.0017841728 0.02442407 -0.1967488 -0.10730509 -0.04234231 -0.048308313 0.08167268 0.14075202 -0.04791197 0.095709346 -0.00039508834 -0.028387519 -0.12931135 0.07175967 -0.2577539 -0.09668729 0.019835126 0.08390751 -0.14297912 0.3197953 -0.3027686 0.2652532 -0.10551424 0.14783493 0.03529992 0.04610823 -0.0746163 0.032330126 0.015001297 -0.23282209 -0.10659642 0.09913879 -0.058567397 0.107539795 0.16343871 0.045880172 -0.36562073 -0.1150111 0.079135254 -0.081988245 -0.14062381 0.21396255 0.0070283376 0.09891861 -0.15961233 -0.014829058 -0.040204123 -0.041554965 0.064516455 -0.17597377 -0.17241801 -0.27929875 0.18177998 -0.17023832 0.058134444 0.050726775 0.02103829 0.16006836 0.0056325197 -0.13922656

```

## Zipping  

```
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github/model$ zip myfasttext_v1.bin.zip myfasttext_v1.bin
  adding: myfasttext_v1.bin (deflated 8%)
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github/model$ ll -h ./myfasttext_v1.bin.zip
-rw-rw-r-- 1 ye ye 708M Dec 25 15:09 ./myfasttext_v1.bin.zip
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github/model$
```

Original filesize:  

```
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github/model$ ll -lh ./myfasttext_v1.bin
-rw-rw-r-- 1 ye ye 766M Dec 25 14:21 ./myfasttext_v1.bin
(base) ye@lst-gpu-server-197:~/ye/exp/sem-chunk/4github/model$
```


